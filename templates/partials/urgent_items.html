{% load sprite_tags %}
<!-- Urgent Items Section -->
{% if urgent_items.overdue or urgent_items.due_today or urgent_items.follow_ups %}
<div class="bg-red-50 border border-red-200 rounded-lg p-6 mb-8"
     hx-get="{% url 'dashboard_urgent' %}"
     hx-trigger="every 60s"
     hx-swap="outerHTML">
    <h3 class="text-lg font-medium text-red-800 mb-4 flex items-center">
        {% sprite "exclamation-triangle" 20 class="text-red-500 mr-2" %}
        Requires Attention
        <button class="ml-auto text-red-600 hover:text-red-800"
                hx-get="{% url 'dashboard_urgent' %}"
                hx-swap="outerHTML"
                title="Refresh urgent items">
            {% sprite "refresh" 24 %}
        </button>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        {% if urgent_items.overdue %}
        <div>
            <h4 class="font-medium text-red-700 mb-2">Overdue Items ({{ urgent_items.overdue|length }})</h4>
            {% for item in urgent_items.overdue %}
            <div class="text-sm text-red-600 mb-1 flex items-center">
                <span class="inline-block w-2 h-2 bg-red-500 rounded-full mr-2"></span>
                {{ item.title }}
                {% if item.due_date %}
                <span class="text-xs text-red-500 ml-2">({{ item.due_date|timesince }} overdue)</span>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if urgent_items.due_today %}
        <div>
            <h4 class="font-medium text-red-700 mb-2">Due Today ({{ urgent_items.due_today|length }})</h4>
            {% for item in urgent_items.due_today %}
            <div class="text-sm text-red-600 mb-1 flex items-center">
                <span class="inline-block w-2 h-2 bg-orange-500 rounded-full mr-2"></span>
                {{ item.title }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if urgent_items.follow_ups %}
        <div>
            <h4 class="font-medium text-red-700 mb-2">Follow-ups Needed ({{ urgent_items.follow_ups|length }})</h4>
            {% for item in urgent_items.follow_ups %}
            <div class="text-sm text-red-600 mb-1 flex items-center">
                <span class="inline-block w-2 h-2 bg-yellow-500 rounded-full mr-2"></span>
                {{ item.title }}
                {% if item.waiting_for_person %}
                <span class="text-xs text-red-500 ml-2">({{ item.waiting_for_person }})</span>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% else %}
<!-- Empty state for urgent items -->
<div class="hidden"
     hx-get="{% url 'dashboard_urgent' %}"
     hx-trigger="every 60s"
     hx-swap="outerHTML">
</div>
{% endif %}