{% load sprite_tags %}

<!-- Search Results -->
<div class="bg-white shadow overflow-hidden sm:rounded-lg" id="search-results">
    <div class="px-4 py-5 sm:px-6 flex justify-between items-center">
        <div>
            <h3 class="text-lg leading-6 font-medium text-gray-900 flex items-center">
                {% sprite "lucide-search" 24 class="text-gray-500 mr-2" %}
                Search Results
            </h3>
            {% if query %}
            <p class="mt-1 max-w-2xl text-sm text-gray-500">
                Found {{ total_results }} result{{ total_results|pluralize }} for "{{ query }}"
            </p>
            {% endif %}
        </div>
    </div>

    {% if query %}
    <div class="border-t border-gray-200">
        {% if items %}
        <ul class="divide-y divide-gray-200">
            {% for item in items %}
            <li class="px-4 py-4 relative">
                {% include 'partials/item_row.html' with item=item %}
            </li>
            {% endfor %}
        </ul>

        <!-- Pagination -->
        {% if items.has_other_pages %}
        <div class="px-4 py-3 border-t bg-gray-50 flex justify-between items-center">
            <div class="text-sm text-gray-700">
                Showing {{ items.start_index }} to {{ items.end_index }} of {{ items.paginator.count }} results
            </div>
            <div class="flex space-x-1">
                {% if items.has_previous %}
                <button hx-get="{% url 'dashboard_search' %}?q={{ query }}&page={{ items.previous_page_number }}"
                        hx-target="#search-results"
                        hx-swap="outerHTML"
                        class="px-3 py-1 text-sm text-gray-500 hover:text-gray-700 border border-gray-300 rounded hover:bg-gray-50">
                    Previous
                </button>
                {% endif %}

                <!-- Page numbers -->
                {% for page_num in items.paginator.page_range %}
                    {% if page_num == items.number %}
                    <span class="px-3 py-1 text-sm text-blue-600 bg-blue-50 border border-blue-300 rounded">
                        {{ page_num }}
                    </span>
                    {% elif page_num|add:"-5" <= items.number and page_num|add:"5" >= items.number %}
                    <button hx-get="{% url 'dashboard_search' %}?q={{ query }}&page={{ page_num }}"
                            hx-target="#search-results"
                            hx-swap="outerHTML"
                            class="px-3 py-1 text-sm text-gray-500 hover:text-gray-700 border border-gray-300 rounded hover:bg-gray-50">
                        {{ page_num }}
                    </button>
                    {% endif %}
                {% endfor %}

                {% if items.has_next %}
                <button hx-get="{% url 'dashboard_search' %}?q={{ query }}&page={{ items.next_page_number }}"
                        hx-target="#search-results"
                        hx-swap="outerHTML"
                        class="px-3 py-1 text-sm text-gray-500 hover:text-gray-700 border border-gray-300 rounded hover:bg-gray-50">
                    Next
                </button>
                {% endif %}
            </div>
        </div>
        {% endif %}
        {% else %}
        <div class="text-center py-12">
            <div class="mx-auto h-12 w-12 text-gray-400">
                {% sprite "lucide-search-x" 48 %}
            </div>
            <h3 class="mt-2 text-sm font-medium text-gray-900">No results found</h3>
            <p class="mt-1 text-sm text-gray-500">Try adjusting your search terms or checking for typos.</p>
        </div>
        {% endif %}
    </div>
    {% else %}
    <div class="text-center py-12">
        <div class="mx-auto h-12 w-12 text-gray-400">
            {% sprite "lucide-search" 48 %}
        </div>
        <h3 class="mt-2 text-sm font-medium text-gray-900">Search your items</h3>
        <p class="mt-1 text-sm text-gray-500">Enter a search term above to find items by title.</p>
    </div>
    {% endif %}
</div>